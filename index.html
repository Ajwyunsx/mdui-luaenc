<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lua代码混淆加密工具</title>
    <link href="https://unpkg.com/mdui@1.0.2/dist/css/mdui.min.css" rel="stylesheet">
    <script src="https://unpkg.com/mdui@1.0.2/dist/js/mdui.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
</head>
<body class="mdui-theme-primary-blue mdui-theme-accent-blue">
    <div class="mdui-appbar">
        <div class="mdui-toolbar mdui-color-blue-700">
            <a href="javascript:;" class="mdui-typo-headline">Lua代码混淆加密工具</a>
            <div class="mdui-toolbar-spacer"></div>
            <div class="toolbar-actions">
            <a href="https://github.com/Ajwyunsx/mdui-luaenc" class="mdui-btn mdui-btn-icon" target="_blank" rel="noopener" aria-label="GitHub" title="打开GitHub仓库">
                <!-- GitHub SVG icon -->
                <svg class="github-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12 2C6.48 2 2 6.58 2 12.26c0 4.52 2.87 8.35 6.84 9.7.5.09.68-.22.68-.48 0-.23-.01-.99-.01-1.79-2.78.62-3.37-1.2-3.37-1.2-.45-1.17-1.11-1.48-1.11-1.48-.9-.63.07-.62.07-.62 1 .07 1.53 1.05 1.53 1.05.89 1.56 2.33 1.11 2.9.85.09-.66.35-1.11.64-1.37-2.22-.26-4.56-1.14-4.56-5.08 0-1.12.39-2.03 1.03-2.75-.1-.26-.45-1.31.1-2.73 0 0 .84-.27 2.75 1.05.8-.23 1.65-.35 2.5-.35.85 0 1.7.12 2.5.35 1.91-1.32 2.75-1.05 2.75-1.05.55 1.42.2 2.47.1 2.73.64.72 1.03 1.63 1.03 2.75 0 3.95-2.34 4.82-4.57 5.08.36.31.68.93.68 1.87 0 1.35-.01 2.44-.01 2.77 0 .26.18.58.69.48A10.03 10.03 0 0 0 22 12.26C22 6.58 17.52 2 12 2z"/>
                </svg>
            </a>
            <button class="mdui-btn mdui-btn-icon theme-toggle" onclick="toggleTheme()" title="切换主题">
                <i class="mdui-icon material-icons">brightness_6</i>
            </button>
            <button id="helpButton" class="mdui-btn mdui-btn-icon" title="帮助">
                <i class="mdui-icon material-icons">help_outline</i>
            </button>
            </div>
        </div>
    </div>

    <div class="mdui-container">
        <div class="mdui-card mdui-m-b-2">
            <div class="mdui-card-content">
                <div class="mdui-typo">
                    <p>
                        <i class="mdui-icon material-icons" style="vertical-align: middle; margin-right: 6px;">info</i>
                        本工具生成的混淆代码适配主流 Lua 环境（5.1–5.4、LuaJIT、AndLua、GGLua），无需选择版本。
                    </p>
                </div>
            </div>
        </div>
        <div class="mdui-row">
            <div class="mdui-col-md-4">
                <div class="mdui-card">
                    <div class="mdui-card-header">
                        <div class="mdui-card-header-title">混淆选项</div>
                    </div>
                    <div class="mdui-card-content">
                        <ul class="mdui-list">
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="controlFlow" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    控制流结构混淆
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="codeLogic" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    代码逻辑流程混淆
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="localVar" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    局部变量命名混淆
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="globalVar" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    全局变量加密处理
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="functionNameObfuscate" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    函数名混淆（含内置print别名）
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="stringEncrypt" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    字符串加密保护
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="numberEncrypt" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    数字加密转换
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="tableEncrypt" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    表结构加密处理
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="booleanObfuscate" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    布尔值混淆变换
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="nilObfuscate" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    空值混淆处理
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="gotoObfuscate" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    跳转语句混淆优化
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="junkCode">
                                    <i class="mdui-checkbox-icon"></i>
                                    花指令植入机制
                                </label>
                            </li>
                            <li class="mdui-list-item mdui-ripple">
                                <label class="mdui-checkbox">
                                    <input type="checkbox" id="oneLine" checked>
                                    <i class="mdui-checkbox-icon"></i>
                                    单行压缩（极限混淆）
                                </label>
                            </li>
                        </ul>
                    </div>
                </div>

                
            </div>

            <div class="mdui-col-md-8">
                <div class="mdui-card">
                    <div class="mdui-card-header">
                        <div class="mdui-card-header-title">源代码</div>
                    </div>
                    <div class="mdui-card-content">
                        <div class="mdui-textfield">
                            <textarea class="mdui-textfield-input" id="sourceCode" rows="20" placeholder="在此输入Lua源代码..."></textarea>
                        </div>
                        <div class="mdui-row mdui-m-t-2">
                            <div class="mdui-col-xs-6">
                                <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-blue-700" onclick="obfuscateCode()">
                                    <i class="mdui-icon material-icons">security</i> 混淆加密
                                </button>
                                <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-blue-700" onclick="clearSource()">
                                    <i class="mdui-icon material-icons">clear</i> 清空
                                </button>
                            </div>
                            <div class="mdui-col-xs-6 mdui-text-right">
                                <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-blue-700" onclick="loadExample()">
                                    <i class="mdui-icon material-icons">code</i> 加载示例
                                </button>
                                <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-blue-700" onclick="copyResult()">
                                    <i class="mdui-icon material-icons">content_copy</i> 复制结果
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mdui-card mdui-m-t-2">
                    <div class="mdui-card-header">
                        <div class="mdui-card-header-title">混淆结果</div>
                    </div>
                    <div class="mdui-card-content">
                        <div class="mdui-textfield">
                            <textarea class="mdui-textfield-input" id="obfuscatedCode" rows="20" placeholder="混淆后的代码将显示在这里..." readonly></textarea>
                        </div>
                        <div class="mdui-row mdui-m-t-2">
                            <div class="mdui-col-xs-12">
                                <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-green-600" onclick="downloadResult()">
                                    <i class="mdui-icon material-icons">file_download</i> 下载结果
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mdui-container footer-card">
        <div class="mdui-card">
            <div class="mdui-card-content">
                <div class="mdui-typo">
                    <p>界面已优化：置顶工具栏、改进留白与字体、支持浅/深色切换。</p>
                </div>
            </div>
        </div>
    </div>

    <div class="mdui-dialog" id="helpDialog">
        <div class="mdui-dialog-title">使用帮助</div>
        <div class="mdui-dialog-content">
            <h4>工具说明</h4>
            <p>这是一个Lua代码混淆加密工具，支持多种混淆技术和Lua环境。</p>
            
            <h4>使用方法</h4>
            <ol>
                <li>在左侧选择需要的混淆选项</li>
                <li>选择目标Lua环境版本</li>
                <li>在源代码区域输入Lua代码</li>
                <li>点击"混淆加密"按钮</li>
                <li>在结果区域查看混淆后的代码</li>
            </ol>
            
            <h4>AndLua特殊处理</h4>
            <p>AndLua系统通过源代码中的require和import语句实现库文件自动导入，在加密AndLua项目时，需要将所有引入语句提取至加密范围外，或手动将相关库文件打包至应用安装包中。</p>
        </div>
        <div class="mdui-dialog-actions">
            <button class="mdui-btn mdui-ripple" mdui-dialog-close>关闭</button>
        </div>
    </div>

    <script src="lua-obfuscator.js"></script>
    <script src="app.js"></script>
    <script>
      function toggleTheme() {
        const body = document.body;
        if (body.classList.contains('mdui-theme-layout-dark')) {
          body.classList.remove('mdui-theme-layout-dark');
          mdui.snackbar({message: '已切换到浅色主题', position: 'top'});
        } else {
          body.classList.add('mdui-theme-layout-dark');
          mdui.snackbar({message: '已切换到深色主题', position: 'top'});
        }
      }
    </script>
</body>
</html>